#### 专题二 大话Nodejs变化 直播课笔记

**http协议那些事儿**
1. http请求模型
> client -> server
> client <- server
>（客户端只能发送请求接收响应，服务端只能接受请求发送响应）

* http 协议是一种无状态的，维持不住当前的通信状态，请求响应是一次操作，结束后就结束了，每次都是独立的
* http 是基于tcp的，到Http3的时候变成基于udp了
2. **浏览器从输入一个url到页面显示出来都发生了什么？一道经典的面试题**
* 输入网址并回车 --> 解析域名 --> 浏览器发送http请求 --> 服务器处理请求 --> 服务器返回html响应 --> 浏览器处理html页面 --> 继续请求其他资源
(用户在浏览器输入一个网址按下回车，首先浏览器确保浏览器是通的，网络分为局域网和互联网，浏览器可以跨过防火墙的边界到达互联网上，互联网上所有的网址都要有一个Ip，在链路层上要识别这些服务就需要给它一个编码（就是ip），现在主要使用的是ipv4(是由一个整型数据组成的)，国家目前在推行ipv6，ipv6可以提供更多的ip地址，ip地址相当于门牌号码，DNS就是用来转换域名和Ip的，拿到ip地址的服务器之后，浏览器就开始上路了，中间会经过很多层路由，找到服务器后，服务器把浏览器需要的数据返回给它，然后浏览器拿到数据后，再经过一系列路由，回到用户面前，这一阶段是浏览器在网络层面的工作，在用户看到页面之前，浏览器还需要做很多资源整合和渲染，用户才能看到)

* ipv4是第四版的ip协议
* dns是用来转换ip和域名的，常用的是互联网的DNS，但是在局域网也可以配置DNS
* 一个Ip地址可以有多个服务器

3. **什么是http协议？**http是超文本传输协议，从www浏览器传输到本地浏览器的一种传输协议，网站是基于http协议的，例如网站的图片、css、js等都是基于http协议进行传输的；HTTP协议是从客户机到服务器的请求和从服务器到客户机的响应进行约束和规范。
* ftp是文件传输协议；ssh协议是远程登录linux系统用的加密协议；

4. **了解TCP/IP协议栈**（四层协议或五层协议）
* 1 应用层：为用户提供所需要的各种服务，例如：HTTP、FTP、DNS、SMTP等。
* 2 传输层：为应用层实体提供端到端的通信功能，保证数据包的顺序传送及数据的完整性。该层定义了两个主要的协议：传输控制协议（TCP）和用户数据协议（UDP）。
* 3 网络层：主要解决主机到主机的通信问题，IP协议是国际互联网层最重要的协议。
* 4 网络接口层：负责监视数据在主机和网络之间的交换。

5. **在TCP/IP协议栈中的位置**
* 目前普遍应用版本是http1.1
* 正在逐步向http 2迁移
* http默认端口号为80
* https默认端口号为443
* https有加密功能

6. **HTTP的工作工程**
* 一次HTTP操作称为一个**事务**，其工作过程可分为四步：
* 1) 首先客户机与服务器需要建立连接。只要单机某个超级链接，HTTP的工作开始。（TCP层面的）
* 2) 建立连接后，客户机发送一个请求给服务器，请求方式的格式为：统计资源标识符（URL）、协议版本号，后边是MIME信息包括请求修饰符、客户机信息和可能的内容（HTTP层面的request）
* 3) 服务器接到请求后，给予相应的响应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后面是MIME信息包括服务器信息、实体信息和可能的内容（HTTP层面的response）
* 4) 客户端接收服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机与服务器断开连接。
* 5) 如果在以上过程中的某一步出现错误。那么产生错误的信息将返回到客户端，有显示屏输出，对于用户来说，这些过程是由HTTP自己完成的，用户只要用鼠标点击，等待信息显示就可以了

7. **HTTP请求方法**

8. **HTTP状态码**

9. **cookies与session**
* Cookies是保存在客户端的小段文本，随客户端点每一个请求发送该url下的所有cookies到服务器端（存在安全问题，别人获取到cookie，就等于拿到了用户的身份，可以对网站进行攻击）
* Session则保存在服务器端，通过唯一的值sessionID来区别每一个用户。sessionID随每个连接请求发送到服务器，服务器根据sessionID来识别客户端，再通过session的key获取session值。（session是服务器上的小型数据库）

10. **浏览器缓存机制**
Etag <--
304本地跳转

11. **HTTPS协议分析**
> https是需要配证书的，这个证书是由CA签发的，如果要使用Https需要先申请证书，然后配置到nginx服务器上，然后才能使用

12. **HTTP2协议分析**
* 使用二进制格式传输，更高效，更紧凑
* 对报头压缩，降低开销
* 多路复用，一个网络连接实现并行请求
* 服务器主动推送，减少请求的延迟(例子：ajax是页面无刷新的，实际上在后台有脚本不断地向服务器提交请求，服务器再把数据响应回来，这样比较耗带宽，http2可以不再使用ajax了，因为服务器拿到数据后主动推送回来，以后Http2发展起来后，ajax估计就不用了)
* 默认使用加密
* 目前使用http2的网站有ke.qq.com(腾讯课堂)、google是最早支持http2的

13. **HTTP2的伪头字段**，伪头字段是http2内置的几个特殊的以“：”开始的key，用于替代http/1.x中请求行/响应行中的信息，比如请求方法，响应状态码等
* :method 目标URL模式部分（请求）
* :scheme 目标URL模式部分（请求）
* :authority 目标URL认证部分（请求）
* :path 目标URL的路径和查询部分（绝对路径产生式和一个跟着“？”字符的查询产生式）（请求）
* :status 响应头中的HTTP状态码部分（响应）
* 请求头里面把自定义的头字段，前面加一个冒号，这样可以和默认的头字段做区分

14. **HTTP3**，将会是一种全新的WEB协议

15. **http与反向代理**
* 什么是代理，什么又是反向代理？
> 代理，自己不方面直接去做的事情，比如：代购（局域网内向局域网外搞事情）
> 反向代理，收到请求之后，先分析URL，根据URL的规则，转发到对应服务器上。
> 反向代理的用途：加密的ssl加速，负载均衡，缓存静态内容，压缩，减速上传，安全，外网发布
* 为什么要使用反向代理？
* 都有哪些反向代理服务器？
> ngnix
* 网络分为：局域网、广域网、互联网


4.5 大规模Node.js项目框架与优化直播课
js是解释型语言
node 核心 libuv
协程


